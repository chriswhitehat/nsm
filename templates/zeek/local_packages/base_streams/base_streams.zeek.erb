#
# /opt/zeek/share/zeek/site/<%= @package[:name] %>/<%= @package[:name] %>.zeek
#
# Generated by Chef for <%= node[:fqdn] %>


########################
# Zeek base streams
########################

event zeek_init()
    {
	################
	# Global
	################

	<% @global_streams.each do |stream, enabled| %>
		<% if enabled %>
	<%= "\#\#Log::disable_stream(#{stream});" %>
		<% else %>
	<%= "Log::disable_stream(#{stream});" %>
		<% end %>
	<% end %>

	################
	# Regional
	################

	<% @regional_streams.each do |stream, enabled| %>
		<% if enabled %>
	<%= "\#\#Log::disable_stream(#{stream});" %>
		<% else %>
	<%= "Log::disable_stream(#{stream});" %>
		<% end %>
	<% end %>

	################
	# Sensor Group 
	# <%= node[:nsm][:sensor_group] %>
	################

	<% @sensor_group_streams.each do |stream, enabled| %>
		<% if enabled %>
	<%= "\#\#Log::disable_stream(#{stream});" %>
		<% else %>
	<%= "Log::disable_stream(#{stream});" %>
		<% end %>
	<% end %>

	################
	# Host
	################

	<% @host_streams.each do |stream, enabled| %>
		<% if enabled %>
	<%= "\#\#Log::disable_stream(#{stream});" %>
		<% else %>
	<%= "Log::disable_stream(#{stream});" %>
		<% end %>
	<% end %>

    }
