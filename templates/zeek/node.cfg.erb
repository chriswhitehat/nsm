#
# /opt/zeek/etc/node.cfg
#
# Generated by Chef for <%= node[:fqdn] %>
#

[manager]
type=manager
host=<%= node[:hostname] %>

[proxy]
type=proxy
host=<%= node[:hostname] %>

<% for sniff in @sniffing_interfaces %>
[<%= sniff[:sensorname] %>]
type=worker
host=<%= node[:hostname] %>
interface=af_packet::<%= sniff[:interface] %>
lb_method=custom
lb_procs=<%= sniff[:zeek][:lb_procs] %>
<% if sniff[:zeek][:numa_tune] %>
pin_cpus=<%= (sniff[:zeek][:numa_cpu]..sniff[:zeek][:numa_cpu]+sniff[:zeek][:lb_procs]-1).to_a.join(",") %>
<% end %>
aux_scripts=networks/<%= sniff[:sensorname] %>

<% end %>
