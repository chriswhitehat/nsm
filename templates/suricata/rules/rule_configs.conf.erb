#
# /etc/suricata/<%= @sniff[:sensorname] %>/<%= @rule_conf %>.conf
#
# Generated by Chef for <%= node[:fqdn] %>
#

# suricata-update - <%= @rule_conf %>.conf

# Example of <%= @rule_conf %> a rule by signature ID (gid is optional).
# 1:2019401
# 2019401

# Example of <%= @rule_conf %> a rule by regular expression.
# - All regular expression matches are case insensitive.
# re:heartbleed
# re:MS(0[7-9]|10)-\d+

# Example of <%= @rule_conf %> a group of rules.
# group:emerging-icmp.rules
# group:emerging-dos
# group:emerging*


##########################
# Global
##########################

<% @global_sigs.each do |sig, enabled| %>
	<% if enabled %>
<%= "#{sig}" %>
	<% else %>
<%= "\##{sig}" %>
	<% end %>
<% end %>

##########################
# Sensor Region
# <%= @sniff[:sensor_region] %>
##########################

<% @sensor_region_sigs.each do |sig, enabled| %>
	<% if enabled %>
<%= "#{sig}" %>
	<% else %>
<%= "\##{sig}" %>
	<% end %>
<% end %>

##########################
# Sensor Group 
# <%= @sniff[:sensor_group] %>
##########################

<% @sensor_group_sigs.each do |sig, enabled| %>
	<% if enabled %>
<%= "#{sig}" %>
	<% else %>
<%= "\##{sig}" %>
	<% end %>
<% end %>

##########################
# Host Chef FQDN
# <%= node[:fqdn] %>
##########################

<% @host_sigs.each do |sig, enabled| %>
	<% if enabled %>
<%= "#{sig}" %>
	<% else %>
<%= "\##{sig}" %>
	<% end %>
<% end %>

##########################
# Sensor 
# <%= @sniff[:sensorname] %>
##########################

<% @sensor_sigs.each do |sig, enabled| %>
	<% if enabled %>
<%= "#{sig}" %>
	<% else %>
<%= "\##{sig}" %>
	<% end %>
<% end %>
