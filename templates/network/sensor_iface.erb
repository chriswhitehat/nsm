#!/bin/bash

#
# /etc/networkd-dispatcher/configured.d/10-disable-offloading-<%= @sensor[:interface] %>
#
# Generated by Chef for <%= node[:fqdn] %>
#

if [ "$IFACE" == "<%= @sensor[:interface] %>" ];
then
    ip link set dev <%= @sensor[:interface] %> promisc on
    ip link set dev <%= @sensor[:interface] %> arp off
    ip link set dev <%= @sensor[:interface] %> mtu <%= @sensor[:mtu] %>
    for i in <%= @sensor[:nic_offloading] %>; do ethtool -K $IFACE $i off; done
fi


